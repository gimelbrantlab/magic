# Copyright (C) 2017 Dana-Farber Cancer Institute Inc.

# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

# Questions, comments and concerns can be directed to
#   Alexander Gimelbrant: alexander_gimelbrant@dfci.harvard.edu
#   Sebastien Vigneau: Sebastien_Vigneau@dfci.harvard.edu
#   Svetlana Vinogradova: Svetlana_Vinogradova@dfci.harvard.edu
#   Henry Ward: henry.neil.ward@gmail.com
#   Sachit Saksena: sachitdsaksena@utexas.edu

#######
# MAIN SERVER
#######


# Gets selected input folder
observeEvent(
  ignoreNULL = TRUE,
  eventExpr = {
    input$processingDir
  },
  handlerExpr = {
    if (input$processingDir > 0) {
      temp_dir <- choose.dir(default = readDirectoryInput(session, 'processingDir'))
      updateDirectoryInput(session, 'processingDir', value = temp_dir)
    }
  }
)

# action buttons between tabs
observeEvent(
  input$get_started,
  {updateTabsetPanel(session = session, 
                     inputId = "main_panel", 
                     selected = "input")}
)

observeEvent(
  input$next_process,
  {updateTabsetPanel(session = session, 
                     inputId = "main_panel", 
                     selected = "process")}
)

observeEvent(
  input$next_generate,
  {updateTabsetPanel(session = session, 
                     inputId = "main_panel", 
                     selected = "generate")}
)

observeEvent(
  input$next_analyze,
  {updateTabsetPanel(session = session, 
                     inputId = "main_panel", 
                     selected = "analyze")}
)